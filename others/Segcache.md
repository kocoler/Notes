Segcache
===

主要思想：基于数据段，管理缓存数据

**Segment**

三个特性：
- 将创建时间和过期时间相似的对象**分组存储**；
- 将每个对象的**元数据**合并存储到**数据段头**中；
- 以**数据段为维度**执行批量过期和驱逐操作；

Segcache 在架构设计上主要遵循如下所示的三大设计原则：
- 主动移除内存中过期的对象，提高内存的利用率；
- 在不同对象之间共享元数据，保证功能的同时减少元数据带来的额外开销；
- 在段的维度上批量过期或者驱逐对象，提高锁的粒度；

该系统主要由 TTL 桶、对象存储和哈希表三个部分组成：

![图 5](https://i.loli.net/2021/07/15/KdoulGH5sm19Lhr.png)  


因为 Segcache 会以数据段为单位驱逐，所以会提高缓存的丢失率。为了解决这个问题，Segcache 会使用基于合并的驱逐算法，它会组合内存中的多个数据段、选择其中会经常访问的一小部分对象并驱逐余下的对象。

性能：
Segcache 在生产环境中可以减少 22 ~ 60% 的内存使用，单线程提供的吞吐量也比 Memcached 好 40% 左右。与此同时，因为 Segcache 具有良好的水平扩展性，它在 24 线程下的性能会比 Memcached 好 8 倍。
