# 常见容错处理

对于线程不安全的类，并发情况下可能会出现fail-fast情况；而线程安全的类，可能出现fail-safe的情况。

- failover：失效转移

  Fail-Over的含义为“失效转移”，是一种备份操作模式，当主要组件异常时，其功能转移到备份组件。
  其要点在于有主有备，且主故障时备可启用，并设置为主。
  如Mysql的双Master模式，当正在使用的Master出现故障时，可以拿备Master做主使用。

  

- failfast：快速失败

  从字面含义看就是“快速失败”，尽可能的发现系统中的错误，使系统能够按照事先设定好的错误的流程执行，对应的方式是“fault-tolerant（错误容忍）”。

  如果出现故障，则立即报错。

  通常用于非幂等性操作，如：下单操作，如果写入故障，则立即报错，不必重试。

  

- failback：失效自动恢复
  
Fail-over之后的自动恢复，在簇网络系统（有两台或多台服务器互联的网络）中，由于要某台服务器进行维修，需要网络资源和服务暂时重定向到备用系统。在此之后将网络资源和服务器恢复为由原始主机提供的过程，称为自动恢复。
  
  
  
- failsafe：失效安全

  Fail-Safe的含义为“失效安全”，即使在故障的情况下也不会造成伤害或者尽量减少伤害。维基百科上一个形象的例子是红绿灯的“冲突监测模块”当监测到错误或者冲突的信号时会将十字路口的红绿灯变为闪烁错误模式，而不是全部显示为绿灯。

  如果出现故障，则可以忽略，因为这种故障不会造成损失或损失在可接受范围内。

  通常用于辅助性操作，如：写入监控日志，如果写入故障，则忽略。

  

- Forking 并行调用多个服务器

  只要一个成功即返回，通常用于实时性要求较高的读操作。 需要浪费更多服务资源  。

  

- Broadcast 

  广播调用，所有提供逐个调用，任意一台报错则报错。通常用于更新提供方本地状态，速度慢，任意一台报错则报错 。 

